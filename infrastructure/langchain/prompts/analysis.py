"""
分析文档生成 Prompt 模版

用于生成项目架构分析、模块分析、核心类分析等文档。
基于 es install.md 中定义的九宫格分析框架。
"""

# ============================================================================
# 系统 Prompt
# ============================================================================

ARCHITECTURE_ANALYSIS_SYSTEM = """你是一位资深的开源项目分析专家，专注于帮助开发者理解复杂的代码架构。

你的职责是：
1. 深入分析项目的整体架构和设计理念
2. 识别核心模块、关键类和重要方法
3. 梳理数据流和核心业务流程
4. 总结设计亮点和最佳实践

分析原则：
- 由浅入深，先整体后局部
- 结合代码实例进行说明
- 关注设计模式和架构思想
- 突出可借鉴的实践经验

输出要求：
- 使用 Markdown 格式
- 代码示例使用对应语言的代码块
- 保持专业但易于理解的语言风格
- 适当使用图表或列表增强可读性"""


# ============================================================================
# 架构全景分析 Prompt
# ============================================================================

ARCHITECTURE_ANALYSIS_PROMPT = """请分析以下开源项目的整体架构。

## 项目信息
- **项目名称**: {project_name}
- **项目类型**: {project_type}
- **主要语言**: {language}
- **项目描述**: {description}

## 项目结构
```
{project_structure}
```

## 相关代码片段
{code_context}

## 分析要求

请按照以下结构进行分析：

### 1. 项目定位与目标
- 项目解决的核心问题
- 目标用户群体
- 与同类项目的差异

### 2. 整体架构设计
- 架构风格（单体/微服务/模块化等）
- 分层结构说明
- 核心组件及其职责
- 组件间的依赖关系

### 3. 技术栈分析
- 主要框架和库
- 技术选型理由（如能推断）
- 版本要求和兼容性

### 4. 入口点与启动流程
- 应用入口文件
- 初始化顺序
- 配置加载机制

### 5. 架构图
请用 Mermaid 语法绘制架构图：
```mermaid
graph TB
    subgraph ...
    end
```

请确保分析准确、深入，帮助学习者快速建立对项目的整体认知。"""


# ============================================================================
# 模块划分分析 Prompt
# ============================================================================

MODULE_ANALYSIS_PROMPT = """请分析项目的模块划分和组织结构。

## 项目信息
- **项目名称**: {project_name}
- **分析范围**: {scope}

## 目录结构
```
{directory_structure}
```

## 模块代码概览
{module_overview}

## 分析要求

请按以下结构分析模块划分：

### 1. 模块清单
| 模块名称 | 路径 | 主要职责 | 依赖模块 |
|---------|------|---------|---------|
| ... | ... | ... | ... |

### 2. 模块职责详解
对每个核心模块进行说明：
- 模块定位
- 包含的主要功能
- 对外提供的接口
- 内部实现要点

### 3. 模块间关系
- 依赖关系图（Mermaid）
- 数据流向
- 调用链路

### 4. 模块设计评价
- 内聚性分析
- 耦合度评估
- 可复用性评价
- 改进建议（如有）

### 5. 学习建议
- 推荐的模块学习顺序
- 每个模块的学习重点"""


# ============================================================================
# 核心类分析 Prompt
# ============================================================================

CORE_CLASS_ANALYSIS_PROMPT = """请深入分析项目中的核心类。

## 项目信息
- **项目名称**: {project_name}
- **分析模块**: {module_name}

## 类定义代码
```{language}
{class_code}
```

## 相关上下文
{related_context}

## 分析要求

请对核心类进行以下分析：

### 1. 类基本信息
- **类名**: 
- **所属模块**: 
- **继承关系**: 
- **实现接口**: 
- **设计模式**: 

### 2. 职责分析
- 核心职责描述
- 单一职责原则遵循情况
- 与其他类的协作关系

### 3. 属性分析
| 属性名 | 类型 | 访问级别 | 用途说明 |
|--------|------|---------|---------|
| ... | ... | ... | ... |

### 4. 方法分析
| 方法名 | 参数 | 返回值 | 核心功能 |
|--------|------|--------|---------|
| ... | ... | ... | ... |

### 5. 生命周期
- 对象创建方式
- 状态转换
- 资源管理

### 6. 使用示例
```{language}
// 典型使用场景示例代码
```

### 7. 设计亮点与启示
- 值得学习的设计点
- 可能的改进空间"""


# ============================================================================
# 关键方法分析 Prompt
# ============================================================================

KEY_METHOD_ANALYSIS_PROMPT = """请深入分析以下关键方法的实现。

## 方法信息
- **方法名**: {method_name}
- **所属类**: {class_name}
- **所属模块**: {module_name}

## 方法代码
```{language}
{method_code}
```

## 调用上下文
{call_context}

## 分析要求

请进行以下分析：

### 1. 方法概述
- 功能描述
- 输入参数说明
- 返回值说明
- 异常处理

### 2. 算法/逻辑分析
- 核心算法说明
- 逻辑流程图（Mermaid）
```mermaid
flowchart TD
    A[开始] --> B[...]
```
- 时间复杂度
- 空间复杂度

### 3. 代码逐行解析
```{language}
// 带注释的代码解析
{annotated_code}
```

### 4. 依赖分析
- 调用的外部方法
- 依赖的类和模块
- 副作用说明

### 5. 边界条件与异常处理
- 边界条件处理
- 异常场景
- 防御性编程实践

### 6. 性能考量
- 潜在性能瓶颈
- 优化建议

### 7. 测试建议
- 核心测试用例
- 边界测试场景"""


# ============================================================================
# 核心流程分析 Prompt
# ============================================================================

CORE_FLOW_ANALYSIS_PROMPT = """请分析项目的核心业务流程。

## 项目信息
- **项目名称**: {project_name}
- **流程名称**: {flow_name}
- **流程描述**: {flow_description}

## 相关代码
{flow_code}

## 分析要求

请进行以下分析：

### 1. 流程概述
- 流程目的
- 触发条件
- 参与组件

### 2. 流程图
```mermaid
sequenceDiagram
    participant A as 组件A
    participant B as 组件B
    A->>B: 调用
    B-->>A: 响应
```

### 3. 详细步骤分析
| 步骤 | 组件 | 操作 | 输入 | 输出 | 说明 |
|------|------|------|------|------|------|
| 1 | ... | ... | ... | ... | ... |

### 4. 数据流转
- 数据起点
- 数据转换过程
- 数据终点
- 关键数据结构

### 5. 关键决策点
- 条件分支
- 异常处理分支
- 回滚机制

### 6. 性能与可靠性
- 耗时操作识别
- 失败重试机制
- 事务处理

### 7. 扩展点
- 可扩展的位置
- 插件/钩子机制"""


# ============================================================================
# 设计亮点分析 Prompt
# ============================================================================

DESIGN_HIGHLIGHTS_PROMPT = """请总结项目的设计亮点和创新之处。

## 项目信息
- **项目名称**: {project_name}
- **项目类型**: {project_type}

## 项目代码概览
{code_overview}

## 分析要求

请从以下维度总结设计亮点：

### 1. 架构设计亮点
- 创新的架构模式
- 优雅的分层设计
- 模块化设计实践

### 2. 代码设计亮点
- 设计模式应用
- 代码复用技巧
- 接口设计精妙之处

### 3. 性能优化亮点
- 缓存策略
- 异步处理
- 资源池化
- 算法优化

### 4. 可扩展性设计
- 插件机制
- 配置化设计
- 依赖注入

### 5. 健壮性设计
- 异常处理策略
- 容错机制
- 日志与监控

### 6. 开发体验优化
- API 设计友好度
- 文档完善程度
- 工具链支持

### 7. 可借鉴清单
| 亮点 | 实现方式 | 适用场景 | 学习价值 |
|------|---------|---------|---------|
| ... | ... | ... | ⭐⭐⭐⭐⭐ |"""


# ============================================================================
# 最佳实践总结 Prompt
# ============================================================================

BEST_PRACTICES_PROMPT = """请总结从该项目中可以学习的最佳实践。

## 项目信息
- **项目名称**: {project_name}
- **技术栈**: {tech_stack}
- **项目规模**: {project_scale}

## 代码示例集合
{code_examples}

## 分析要求

请按类别总结最佳实践：

### 1. 代码组织最佳实践
- 目录结构规范
- 命名约定
- 模块划分原则

### 2. 编码规范实践
- 代码风格
- 注释规范
- 类型标注

### 3. 错误处理实践
- 异常定义
- 错误传播
- 用户友好的错误信息

### 4. 配置管理实践
- 配置分离
- 环境变量管理
- 默认值处理

### 5. 测试实践
- 测试组织
- Mock 策略
- 测试覆盖

### 6. 文档实践
- 代码文档
- API 文档
- 使用指南

### 7. 实践检查清单
为学习者提供一份检查清单：
- [ ] 实践项 1
- [ ] 实践项 2
- [ ] ...

### 8. 反模式警示
同时指出项目中可能存在的反模式或需要避免的做法。"""


# ============================================================================
# 九宫格综合分析模版（用于生成完整分析文档）
# ============================================================================

NINE_SECTIONS_ANALYSIS_PROMPT = """请对项目进行九宫格全面分析。

## 项目信息
- **项目名称**: {project_name}
- **GitHub 地址**: {repo_url}
- **项目类型**: {project_type}
- **主要语言**: {language}
- **项目描述**: {description}

## 项目数据
{project_data}

## 九宫格分析框架

请按照以下九个维度生成完整的分析文档：

---

## 一、架构全景

### 1.1 项目定位
{project_positioning}

### 1.2 架构概览
[请根据代码分析填充]

### 1.3 架构图
```mermaid
[请生成架构图]
```

---

## 二、模块划分

### 2.1 核心模块
[请根据目录结构和代码分析]

### 2.2 模块关系图
```mermaid
[请生成模块关系图]
```

---

## 三、核心类

### 3.1 关键类清单
[请识别并列出核心类]

### 3.2 类关系图
```mermaid
[请生成类图]
```

---

## 四、关键方法

### 4.1 核心方法清单
[请识别关键方法]

### 4.2 方法调用链
[请分析方法调用关系]

---

## 五、数据流

### 5.1 主要数据结构
[请分析核心数据结构]

### 5.2 数据流转图
```mermaid
[请生成数据流图]
```

---

## 六、核心流程

### 6.1 业务流程概览
[请识别核心业务流程]

### 6.2 流程时序图
```mermaid
[请生成时序图]
```

---

## 七、配置系统

### 7.1 配置项说明
[请分析配置系统]

### 7.2 环境变量
[请列出关键环境变量]

---

## 八、设计亮点

### 8.1 架构亮点
[请总结设计亮点]

### 8.2 代码亮点
[请总结代码层面的亮点]

---

## 九、最佳实践

### 9.1 可借鉴的实践
[请总结最佳实践]

### 9.2 学习建议
[请给出学习路径建议]

---

请确保分析全面、深入，为学习者提供有价值的参考。"""
