# TASK-010: Tutor Agent ä¸ Explainer Agent

## åŸºæœ¬ä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| **ä»»åŠ¡ç¼–å·** | TASK-010 |
| **ä»»åŠ¡åç§°** | Tutor Agent ä¸ Explainer Agent |
| **ç‰ˆæœ¬** | V0.4 |
| **çŠ¶æ€** | ğŸ”µ è§„åˆ’ä¸­ |
| **ä¼˜å…ˆçº§** | P0 - æœ€é«˜ |
| **é¢„è®¡å·¥æ—¶** | 4-5 å¤© |
| **å‰ç½®ä»»åŠ¡** | TASK-003, TASK-009 |

---

## ä»»åŠ¡æè¿°

å®ç°å­¦ä¹ æ•™ç»ƒ (Tutor Agent) å’Œä»£ç è®²è§£ (Explainer Agent) ä¸¤ä¸ªæ ¸å¿ƒå­ Agentã€‚Tutor Agent è´Ÿè´£è‹æ ¼æ‹‰åº•å¼æ•™å­¦å¼•å¯¼ï¼ŒExplainer Agent è´Ÿè´£åŸºäº RAG çš„ä»£ç è®²è§£ã€‚

### ä¸»è¦å·¥ä½œå†…å®¹

1. **Tutor Agent (`application/agents/subagents/tutor_agent.py`)**
   
   **èŒè´£ï¼š**
   - é©±åŠ¨é—®é¢˜é©±åŠ¨çš„å­¦ä¹ æµç¨‹
   - è¯„ä¼°å›ç­”çš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§
   - æä¾›è‹æ ¼æ‹‰åº•å¼å¼•å¯¼åé¦ˆ
   - æ§åˆ¶çŸ¥è¯†æŠ«éœ²èŠ‚å¥ï¼ˆå…ˆå¼•å¯¼æ€è€ƒï¼Œå†ç»™ç­”æ¡ˆï¼‰
   - é€‰æ‹©ä¸‹ä¸€ä¸ªé—®é¢˜
   
   **å·¥å…·å®šä¹‰ï¼š**
   - `evaluate_answer(answer: str, question_id: str, reference: str) -> dict`
     - è¿”å›ï¼šscore, correct_points, incomplete_points, incorrect_points
   - `generate_socratic_feedback(evaluation: dict, context: str) -> dict`
     - è¿”å›ï¼šfeedback_text, hints, recommended_files
   - `delegate_to_explainer(question_id: str, gaps: list) -> str`
     - è°ƒç”¨ Explainer ç”Ÿæˆè®²è§£
   - `select_next_question(progress: dict) -> dict`
     - æ ¹æ®è¿›åº¦é€‰æ‹©ä¸‹ä¸€é¢˜
   
   **System Prompt æ ¸å¿ƒè¦ç‚¹ï¼š**
   - è‹æ ¼æ‹‰åº•å¼æé—®ï¼šå…ˆå¼•å¯¼æ€è€ƒï¼Œå†ç»™äºˆå¼•å¯¼
   - å¾ªåºæ¸è¿›ï¼šä»æ•´ä½“åˆ°ç»†èŠ‚ï¼Œä»ç®€å•åˆ°å¤æ‚
   - ä»£ç ä¸ºè¯ï¼šæ‰€æœ‰è§£é‡Šå¿…é¡»åŸºäºå®é™…ä»£ç 
   - ç§¯æé¼“åŠ±ï¼šè‚¯å®šæ­£ç¡®ç†è§£ï¼Œæ¸©å’ŒæŒ‡å‡ºä¸è¶³

2. **Explainer Agent (`application/agents/subagents/explainer_agent.py`)**
   
   **èŒè´£ï¼š**
   - åŸºäºä»£ç æ£€ç´¢ç”Ÿæˆå‡†ç¡®è®²è§£
   - å¼•ç”¨å…·ä½“æ–‡ä»¶è·¯å¾„å’Œè¡Œå·
   - è§£é‡Šè®¾è®¡æ„å›¾ï¼Œä¸ä»…æè¿°åŠŸèƒ½
   - ä¿¡æ¯ä¸è¶³æ—¶æ˜ç¡®è¯´æ˜
   
   **å·¥å…·å®šä¹‰ï¼š**
   - `search_code(query: str, project_id: str, top_k: int) -> list`
     - è¯­ä¹‰æœç´¢ä»£ç ç‰‡æ®µ
   - `search_symbols(keywords: list, project_id: str) -> list`
     - ç¬¦å·æœç´¢è¡¥å……
   - `get_code_context(file_path: str, lines: tuple) -> str`
     - è·å–ä»£ç ä¸Šä¸‹æ–‡
   
   **è¾“å‡ºæ ¼å¼ï¼š**
   ```json
   {
     "summary": "è¿™æ®µä»£ç å®ç°äº†...",
     "code_references": [
       {
         "file": "src/main.py",
         "lines": [10, 25],
         "snippet": "def process():\n    ...",
         "explanation": "è¿™æ˜¯æ ¸å¿ƒå¤„ç†å‡½æ•°..."
       }
     ],
     "key_insights": ["è®¾è®¡äº®ç‚¹1", "è®¾è®¡äº®ç‚¹2"]
   }
   ```

3. **è¯„ä¼°ç»´åº¦å®šä¹‰**
   - **æ­£ç¡®æ€§ (Correctness)**ï¼šå›ç­”æ˜¯å¦æ­£ç¡®
   - **å®Œæ•´æ€§ (Completeness)**ï¼šæ˜¯å¦æ¶µç›–å…³é”®ç‚¹
   - **æ·±åº¦ (Depth)**ï¼šç†è§£ç¨‹åº¦
   - **ä»£ç å…³è” (Code Reference)**ï¼šæ˜¯å¦å¼•ç”¨å…·ä½“ä»£ç 

4. **åé¦ˆç”Ÿæˆç­–ç•¥**
   - è¯„åˆ† >= 80ï¼šè‚¯å®š + å°è¡¥å…… + ä¸‹ä¸€é¢˜
   - è¯„åˆ† 60-79ï¼šè‚¯å®š + å¼•å¯¼æ€è€ƒ + æç¤ºæŸ¥çœ‹ä»£ç 
   - è¯„åˆ† < 60ï¼šè‚¯å®šæ­£ç¡®éƒ¨åˆ† + å¼•å¯¼é—®é¢˜ + å±•ç¤ºæ ‡å‡†ç­”æ¡ˆ

---

## éªŒæ”¶æ ‡å‡†

- [ ] Tutor èƒ½æ­£ç¡®è¯„ä¼°å›ç­”çš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§
- [ ] Tutor è¯„åˆ†ä¸äººå·¥è¯„ä¼°å·®å¼‚ < 15%
- [ ] Tutor åé¦ˆåŒ…å«å…·ä½“çš„æ”¹è¿›å»ºè®®
- [ ] Tutor æ¨èçš„ä»£ç ä½ç½®ä¸é—®é¢˜ç›¸å…³
- [ ] Explainer ç”Ÿæˆçš„è®²è§£å¼•ç”¨çœŸå®ä»£ç 
- [ ] Explainer ä¸ç¼–é€ ä¸å­˜åœ¨çš„ä»£ç 
- [ ] Explainer è®²è§£åŒ…å«è®¾è®¡æ„å›¾è¯´æ˜
- [ ] å•æ¬¡è¯„ä¼°å“åº”æ—¶é—´ < 10 ç§’
- [ ] å•æ¬¡è®²è§£ç”Ÿæˆæ—¶é—´ < 15 ç§’
- [ ] æ”¯æŒæµå¼è¾“å‡ºåé¦ˆ

---

## æ³¨æ„äº‹é¡¹

1. **è‹æ ¼æ‹‰åº•å¼æ•™å­¦åŸåˆ™**
   ```
   âŒ ç›´æ¥ç»™ç­”æ¡ˆï¼š"è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯..."
   âœ… å¼•å¯¼æ€è€ƒï¼š"ä½ è§‰å¾—è¿™ä¸ªå‡½æ•°ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ"
   
   âŒ å¦å®šå¼åé¦ˆï¼š"ä½ çš„å›ç­”æ˜¯é”™è¯¯çš„"
   âœ… å»ºè®¾æ€§åé¦ˆï¼š"ä½ æåˆ°äº† Xï¼Œè¿™æ˜¯å¯¹çš„ï¼ä¸è¿‡è¿˜å¯ä»¥è€ƒè™‘ Y..."
   ```

2. **ä»£ç å¼•ç”¨è§„èŒƒ**
   ```markdown
   è¿™ä¸ªå‡½æ•°å®šä¹‰åœ¨ `src/agent/tutor.py:45-78`:
   
   ```python
   def evaluate(self, answer: str) -> Evaluation:
       ...
   ```
   ```

3. **è¯„ä¼°ä¸€è‡´æ€§**
   - å®šä¹‰æ¸…æ™°çš„è¯„åˆ†æ ‡å‡†
   - ä½¿ç”¨ç»“æ„åŒ– Prompt ç¡®ä¿ä¸€è‡´æ€§
   - è€ƒè™‘æ·»åŠ  Few-shot ç¤ºä¾‹

4. **ä¸Šä¸‹æ–‡ç®¡ç†**
   - Tutor éœ€è¦è®°ä½ä¹‹å‰çš„å¯¹è¯
   - ä½¿ç”¨ LangGraph çŠ¶æ€ç®¡ç†
   - æˆ–ä½¿ç”¨ DeepAgents FilesystemMiddleware

5. **RAG å‡†ç¡®æ€§**
   - Explainer å¿…é¡»åŸºäºæ£€ç´¢ç»“æœ
   - æ£€ç´¢ç»“æœä¸è¶³æ—¶æ˜ç¡®è¯´æ˜
   - ä¸å…è®¸"å¹»è§‰"ç¼–é€ ä»£ç 

---

## ç›¸å…³æ–‡æ¡£

- [æ¶æ„è®¾è®¡æ–‡æ¡£ - 6.5 Tutor Agent](../docs/code-learning-coach-architecture.md#65-tutor-agentå­¦ä¹ æ•™ç»ƒæ™ºèƒ½ä½“)
- [æ¶æ„è®¾è®¡æ–‡æ¡£ - 6.6 Explainer Agent](../docs/code-learning-coach-architecture.md#66-explainer-agentä»£ç è®²è§£æ™ºèƒ½ä½“)
- [PRD - 3.2 å…³é”®å­æ™ºèƒ½ä½“](../docs/es%20install.md)
