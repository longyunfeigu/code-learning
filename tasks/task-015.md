# TASK-015: Web 前端界面

## 基本信息

| 属性 | 值 |
|------|-----|
| **任务编号** | TASK-015 |
| **任务名称** | Web 前端界面 |
| **版本** | V0.6 |
| **状态** | 🔵 规划中 |
| **优先级** | P1 - 高 |
| **预计工时** | 5-7 天 |
| **前置任务** | TASK-012, TASK-013 |

---

## 任务描述

开发 Web 前端界面，提供项目管理、学习会话、问答交互、分析文档浏览等功能。采用现代前端技术栈，支持响应式设计。

### 主要工作内容

1. **技术选型**
   - 框架：React 18 / Vue 3
   - 状态管理：Zustand / Pinia
   - UI 组件库：Ant Design / Element Plus
   - 样式：Tailwind CSS
   - 构建工具：Vite
   - WebSocket：原生 WebSocket / Socket.io

2. **页面结构**
   
   ```
   /                           # 首页（项目列表）
   /projects/new               # 创建项目
   /projects/:id               # 项目详情
   /projects/:id/analysis      # 分析文档
   /sessions/:id               # 学习会话
   /sessions/:id/notes         # 笔记管理
   /settings                   # 偏好设置
   ```

3. **核心页面设计**
   
   **首页/项目列表：**
   - 项目卡片列表
   - 项目状态标识（分析中/就绪/失败）
   - 创建新项目入口
   - 搜索和筛选
   
   **学习会话页面（核心）：**
   - 左侧：学习阶段导航 + 问题列表
   - 中间：对话区域（Tutor 对话）
   - 右侧：推荐文件 + 代码预览 + 当前章节摘要
   - 底部：能力模块快捷切换
   
   **分析文档页面：**
   - 章节目录导航
   - Markdown 渲染
   - 代码高亮
   - 导出按钮

4. **交互功能**
   
   **WebSocket 实时对话：**
   - 流式消息展示
   - 打字机效果
   - 发送状态指示
   - 断线重连
   
   **代码高亮：**
   - 使用 Prism.js 或 highlight.js
   - 支持多语言
   - 行号显示
   - 复制按钮
   
   **进度追踪：**
   - 学习进度条
   - 问题完成状态
   - 能力模块完成度

5. **响应式设计**
   - 桌面端：三栏布局
   - 平板端：可折叠侧边栏
   - 移动端：单栏布局 + 底部导航

---

## 验收标准

- [ ] 所有页面在 Chrome/Firefox/Safari 正常显示
- [ ] 响应式布局支持桌面/平板/移动端
- [ ] WebSocket 连接稳定，支持断线重连
- [ ] 流式消息展示流畅，无卡顿
- [ ] 代码高亮支持至少 10 种语言
- [ ] 页面首屏加载时间 < 3 秒
- [ ] 所有交互有明确的加载/成功/错误状态
- [ ] 支持深色/浅色主题切换
- [ ] 基本的无障碍支持 (ARIA)

---

## 注意事项

1. **学习会话页面布局**
   ```
   ┌────────────────────────────────────────────────────────────┐
   │ Header (项目名称 | 进度条 | 设置)                           │
   ├──────────┬───────────────────────────┬────────────────────┤
   │ 学习阶段  │                           │ 推荐文件           │
   │ ├ 架构   │      对话区域              │ ├ src/main.py     │
   │ ├ 模块   │                           │ └ src/agent/      │
   │ └ 设计   │  [输入消息]               │                    │
   │          │  [Tutor 回复...]          │ 代码预览           │
   │ ──────── │                           │ ┌──────────────┐  │
   │ 问题列表  │                           │ │ def main():  │  │
   │ □ 问题1  │  ┌─────────────────────┐  │ │   ...        │  │
   │ ■ 问题2  │  │ 输入框              │  │ └──────────────┘  │
   │ □ 问题3  │  └─────────────────────┘  │                    │
   └──────────┴───────────────────────────┴────────────────────┘
   ```

2. **WebSocket 消息处理**
   ```javascript
   const ws = new WebSocket(`ws://api/ws/agents/${sessionId}`);
   
   ws.onmessage = (event) => {
     const msg = JSON.parse(event.data);
     switch(msg.type) {
       case 'stream_chunk':
         appendToLastMessage(msg.content);
         break;
       case 'stream_end':
         finalizeMessage(msg.message_id);
         break;
       case 'progress_update':
         updateProgress(msg.data);
         break;
     }
   };
   ```

3. **状态管理**
   - 全局状态：主题设置、API 配置
   - 页面状态：项目列表、当前会话
   - 组件状态：表单输入、UI 状态

4. **错误处理**
   - API 错误显示 Toast 提示
   - 网络错误显示重试选项
   - 会话失效时提示重新连接

5. **性能优化**
   - 路由懒加载
   - 图片懒加载
   - 消息虚拟滚动（长对话）
   - 代码分割

---

## 相关文档

- [架构设计文档 - 1.5 架构全景图](../docs/code-learning-coach-architecture.md#15-架构全景图)
- [PRD - 七、学习流程总览](../docs/es%20install.md)
