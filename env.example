# =============================================================================
# Code Learning Coach - 环境变量配置示例
# =============================================================================
# 使用说明:
# 1. 复制本文件为 .env
# 2. 根据实际环境修改配置值
# 3. 敏感信息请勿提交到版本控制
# =============================================================================

# -----------------------------------------------------------------------------
# 应用基础配置
# -----------------------------------------------------------------------------
APP_NAME=Code Learning Coach
APP_VERSION=1.0.0
DEBUG=false
ENVIRONMENT=development
# 必填: 应用密钥，用于加密等场景，请使用随机字符串
SECRET_KEY=your-secret-key-here-change-in-production

# -----------------------------------------------------------------------------
# 服务器配置
# -----------------------------------------------------------------------------
HOST=0.0.0.0
PORT=8000
RELOAD=true
WORKERS=4

# -----------------------------------------------------------------------------
# 数据库配置 (PostgreSQL)
# -----------------------------------------------------------------------------
DATABASE__URL=postgresql+asyncpg://user:password@localhost:5432/code_learning

# -----------------------------------------------------------------------------
# Redis 配置 (缓存/会话/队列)
# -----------------------------------------------------------------------------
REDIS__URL=redis://localhost:6379/0
REDIS__MAX_CONNECTIONS=10
REDIS__DEFAULT_TTL=300
REDIS__NAMESPACE=code-learning

# -----------------------------------------------------------------------------
# LLM 配置 (大语言模型)
# -----------------------------------------------------------------------------
# LLM 提供商: openai, anthropic, ollama
LLM__PROVIDER=openai
# 默认模型
LLM__MODEL=gpt-4-turbo
# 生成温度 (0.0-2.0)
LLM__TEMPERATURE=0.7
# 请求超时 (秒)
LLM__TIMEOUT=60
# 最大重试次数
LLM__MAX_RETRIES=3

# OpenAI 配置
OPENAI__API_KEY=sk-your-openai-api-key
# 可选: 自定义 API 地址 (代理或兼容 API)
# OPENAI__BASE_URL=https://api.openai.com/v1
# OPENAI__ORGANIZATION=org-xxx

# Anthropic (Claude) 配置
# ANTHROPIC__API_KEY=sk-ant-your-anthropic-api-key

# Ollama 本地模型配置
OLLAMA__BASE_URL=http://localhost:11434

# -----------------------------------------------------------------------------
# Embedding 配置 (向量嵌入)
# -----------------------------------------------------------------------------
# 提供商: openai, huggingface
EMBEDDING__PROVIDER=openai
# 模型名称
EMBEDDING__MODEL=text-embedding-3-small
# HuggingFace 设备 (cpu/cuda)
EMBEDDING__DEVICE=cpu
# 批量处理大小
EMBEDDING__BATCH_SIZE=100

# -----------------------------------------------------------------------------
# 向量数据库配置（仅 Chroma）
# -----------------------------------------------------------------------------
# 提供商: 仅支持 chroma
VECTORSTORE__PROVIDER=chroma
VECTORSTORE__DEFAULT_COLLECTION=code_chunks

# Chroma 配置
CHROMA__PERSIST_DIRECTORY=./data/chroma
# 如需使用 Chroma Server 模式，可配置：
# CHROMA__HOST=localhost
# CHROMA__PORT=8000

# -----------------------------------------------------------------------------
# MinIO 对象存储配置 (存储仓库文件/文档)
# -----------------------------------------------------------------------------
MINIO__ENDPOINT=localhost:9000
MINIO__ACCESS_KEY=minioadmin
MINIO__SECRET_KEY=minioadmin
MINIO__BUCKET=code-learning
MINIO__SECURE=false

# -----------------------------------------------------------------------------
# Git 和代码分析配置
# -----------------------------------------------------------------------------
# 仓库克隆工作目录
GIT__WORKSPACE_DIR=./data/repos
# 默认克隆深度 (shallow clone)
GIT__DEFAULT_CLONE_DEPTH=1
# 克隆超时 (秒)
GIT__CLONE_TIMEOUT=300

# 代码分析配置
CODE_ANALYSIS__MAX_FILE_SIZE=1048576
CODE_ANALYSIS__CHUNK_SIZE=1000
CODE_ANALYSIS__CHUNK_OVERLAP=200

# -----------------------------------------------------------------------------
# 原有存储服务配置
# -----------------------------------------------------------------------------
# Storage type: local, s3, oss
STORAGE__TYPE=local
STORAGE__BUCKET=my-bucket
STORAGE__REGION=us-east-1
STORAGE__ENDPOINT=https://s3.amazonaws.com
STORAGE__PUBLIC_BASE_URL=https://cdn.example.com

# AWS S3 配置
STORAGE__AWS_ACCESS_KEY_ID=your-aws-access-key
STORAGE__AWS_SECRET_ACCESS_KEY=your-aws-secret-key
STORAGE__S3_SSE=AES256
STORAGE__S3_ACL=private

# Aliyun OSS 配置
# STORAGE__OSS_ACCESS_KEY_ID=your-oss-access-key
# STORAGE__OSS_ACCESS_KEY_SECRET=your-oss-secret-key

# Local Storage 配置
STORAGE__LOCAL_BASE_PATH=/tmp/storage

# Storage 高级配置
STORAGE__MAX_RETRY_ATTEMPTS=3
STORAGE__TIMEOUT=30
STORAGE__ENABLE_SSL=true
STORAGE__PRESIGN_MAX_SIZE=104857600
STORAGE__VALIDATION_ENABLED=false
STORAGE__MAX_FILE_SIZE=104857600

# -----------------------------------------------------------------------------
# Celery 任务队列配置
# -----------------------------------------------------------------------------
CELERY__BROKER_URL=redis://localhost:6379/1
CELERY__RESULT_BACKEND=redis://localhost:6379/2

# -----------------------------------------------------------------------------
# CORS 配置
# -----------------------------------------------------------------------------
CORS_ORIGINS=["http://localhost:3000","http://localhost:8080"]
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["*"]
CORS_ALLOW_HEADERS=["*"]

# -----------------------------------------------------------------------------
# 日志配置
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FILE=logs/app.log
LOG_MAX_BYTES=104857600
LOG_BACKUP_COUNT=5

# -----------------------------------------------------------------------------
# 分页配置
# -----------------------------------------------------------------------------
DEFAULT_PAGE_SIZE=20
MAX_PAGE_SIZE=100

# -----------------------------------------------------------------------------
# Kafka 消息队列配置 (可选)
# -----------------------------------------------------------------------------
KAFKA__DRIVER=confluent
KAFKA__BOOTSTRAP_SERVERS=localhost:9092
KAFKA__CLIENT_ID=code-learning

# TLS 配置
KAFKA__TLS_ENABLE=false
KAFKA__TLS_VERIFY=true

# 生产者配置
KAFKA__PRODUCER_ACKS=all
KAFKA__PRODUCER_ENABLE_IDEMPOTENCE=true
KAFKA__PRODUCER_COMPRESSION_TYPE=zstd

# 消费者配置
KAFKA__CONSUMER_ENABLE_AUTO_COMMIT=false
KAFKA__CONSUMER_AUTO_OFFSET_RESET=latest

# -----------------------------------------------------------------------------
# gRPC 配置 (可选)
# -----------------------------------------------------------------------------
GRPC__ENABLED=false
GRPC__HOST=0.0.0.0
GRPC__PORT=50051

# TLS 配置
GRPC__TLS__ENABLED=false
# GRPC__TLS__CERT=/path/to/server.crt
# GRPC__TLS__KEY=/path/to/server.key
# GRPC__TLS__CA=/path/to/ca.crt

# -----------------------------------------------------------------------------
# 监控和追踪 (可选)
# -----------------------------------------------------------------------------
# Sentry 错误追踪
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# LangSmith 追踪 (LangChain 监控)
# LANGCHAIN_TRACING_V2=true
# LANGCHAIN_API_KEY=your-langsmith-api-key
# LANGCHAIN_PROJECT=code-learning-coach
